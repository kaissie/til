# 共通鍵暗号

暗号化と復号に同一の秘密鍵を用いる暗号

## 定義

鍵生成アルゴリズムKeyGen，暗号化アルゴリズムEnc，復号アルゴリズムDecの組（KeyGen,Enc,Dec）で構成される．

## 性質

- 正当性

  暗号文を復号すると元の平文に戻ること

- 秘匿性

  暗号文から平文に関する情報が得られない

## 安全性

### 暗号文単独攻撃（COA）

同一の秘密鍵によって暗号化された暗号文を複数利用しての攻撃

通信路を盗聴するという攻撃に相当する

### 既知平文攻撃（KPA）

「解読対象の暗号文」と「ランダムな平文と暗号文の対」を利用しての攻撃

暗号解読によって過去の平文が特定済みであったりする状況に相当する

### 選択平文攻撃（CPA）

自分で選んだ平文に対する暗号文を得られる状況においての攻撃

暗号化装置を入手していたり，認証サーバを悪用したりする状況に相当する

### 選択暗号文攻撃（CCA）

解読対象の暗号文を受け取る前の時点で，自分で選んだ暗号文に対する平文を得られるという状況での攻撃

復号オラクルを利用して，平文を得る

### 適応的選択暗号文攻撃（CCA2）

解読対象の暗号文を受け取る前後で，自分で選んだ暗号文に対する平文を得られるという状況での攻撃

任意のタイミングで復号オラクルを利用して，平文を得られる

### 鍵全数探索攻撃

秘密鍵に対する総当たり攻撃
どのような共通かぎ暗号にも適用できるため，これに耐えうる鍵長にしなければならない．
鍵長さが$k$ビットの場合，秘密鍵の候補は$2^k$個ある．

## 分類

### ストリーム暗号

平文を小さい単位（ビット，バイト，ワード）で順次処理する暗号
平文と秘密鍵（あるいは疑似乱数）の排他的論理和で暗号化・復号を行う

- バーナム暗号
  最も理想的なストリーム暗号

### ブロック暗号

一定の大きさ（ブロック）の平文を処理する暗号
ブロックよりサイズの大きい平文の場合，暗号化モードが適用される

- DES
  米国の旧国家標準のブロック暗号
- トリプルDES
  DESを多重化し，鍵長を増やした暗号
- AES
  米国の新国家標準のブロック暗号

#### 暗号化モード

ブロック長より長い平文に対応するための仕組み

##### 定義

3つのアルゴリズムの組（ENC-KeyGen, ENC-Enc, ENC-Dec）で構成される

- ENC-KeyGen
  鍵生成アルゴリズム
- ENC-Enc
  暗号化アルゴリズム
- ENC-Dec
  復号アルゴリズム

##### 種類

- ECBモード
  平文をブロック長に分割して，それらを単純にブロック暗号で暗号化

- CBCモード
  1つ前の暗号文ブロックと平文ブロックの排他的論理和を取ってから暗号化

- CFBモード
  1つ前の暗号ブロックを再度暗号化したものと平文の排他的論理和を取る

- OFBモード
  ブロック暗号を用いた疑似乱数生成器から鍵系列を作成
  鍵系列と平文の排他的論理和を取る
  ブロック暗号をストリーム暗号として利用している

- CTRモード

  ブロック暗号の暗号文とカウンタの値を組み合わせて暗号化



